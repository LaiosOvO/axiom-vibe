# SPEC-F02: Deep Research 深度研究

> 里程碑: M2 | 优先级: P0 | 状态: ⚪ 待开始 | 依赖: M1

## 目标

在规划阶段和实现过程中提供深度研究能力：自动搜索竞品、GitHub 仓库、分析技术方案，生成结构化的参考文档。

## 需求

### R1: 研究触发时机

| 触发时机 | 行为 |
|---------|------|
| `/spec:new` 创建新需求 | 先问用户"这是个什么系统"，然后自动搜索 |
| 实现过程中遇到不熟悉的技术 | 按需自动触发 |
| `/research <topic>` | 用户手动触发 |

### R2: 研究流程

```
1. 需求澄清 — 与用户确认：系统类型、核心功能、技术约束
       ↓
2. 竞品搜索 — Google/Web 搜索同类产品和解决方案
       ↓
3. GitHub 搜索 — 搜索相关开源仓库（调用 GitHub 搜索接口）
       ↓
4. 仓库分析 — 对每个符合条件的仓库：
   - 读取 README
   - 分析目录结构
   - 识别技术栈
   - 评估 star 数、活跃度、代码质量
       ↓
5. 生成参考文档 — 输出到 ref/ 文件夹
```

### R3: 参考文档格式

```
ref/
├── <topic>/
│   ├── summary.md          总结文档（竞品对比、推荐方案）
│   ├── repos/
│   │   ├── <repo1>.md      仓库分析报告
│   │   ├── <repo2>.md
│   │   └── ...
│   └── competitors/
│       ├── <product1>.md   竞品分析
│       └── ...
```

每个仓库分析报告包含：
- 基本信息（名称、URL、star、语言、最后更新）
- 功能概述
- 技术栈分析
- 架构模式
- 优缺点
- 可借鉴的点

### R4: 搜索结果过滤和排序

- 按 star 数、最近更新时间、相关度排序
- 过滤掉超过 2 年未更新的仓库
- 至少分析 top 5 个最相关的仓库

## 验收场景

### 场景 1: 解析研究请求

- **当** 解析"搜索 TUI 框架实现"
- **那么** 提取 topic 和关键词

### 场景 2: 生成搜索查询

- **当** 给定系统类型"CLI 工具"和主题"AI 编码助手"
- **那么** 生成 GitHub 和 Web 搜索查询

### 场景 3: 解析仓库分析结果

- **当** 解析仓库数据
- **那么** 返回结构化的报告（name, techStack, pros, cons）

### 场景 4: 生成总结文档

- **当** 基于多个仓库报告生成总结
- **那么** 包含竞品对比和推荐方案

### 场景 5: ref 目录结构

- **当** 保存研究结果
- **那么** 创建正确的 ref/topic/ 目录结构
